<div class="products-page">
  <!-- Page Header -->
  <div class="page-header">
    <h1 class="page-title">Add, Edit & Remove</h1>
    <div class="header-actions">
      <button mat-raised-button color="primary" class="add-button" (click)="addProduct()">
        <mat-icon>add</mat-icon>
        <span>Add</span>
      </button>
      <button mat-stroked-button class="delete-button" type="button">
        <mat-icon>delete</mat-icon>
      </button>
    </div>
  </div>

  <!-- Table Card -->
  <mat-card class="table-card">
    <!-- Search Bar -->
    <div class="search-section">
      <div class="search-wrapper">
        <mat-icon class="search-icon">search</mat-icon>
        <input 
          type="text" 
          [(ngModel)]="searchTerm" 
          (keyup.enter)="onSearch()" 
          placeholder="Search..." 
          class="search-input"
        />
      </div>
    </div>

    <!-- Loading State -->
    @if (loading) {
      <div class="loading-section">
        <mat-spinner diameter="50"></mat-spinner>
        <p class="loading-text">Loading products...</p>
      </div>
    }

    <!-- Table Content -->
    @if (!loading) {
      <div class="table-section">
        <div class="table-container">
          <table mat-table [dataSource]="products" class="products-table">
            <!-- ID Column -->
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef class="sortable-header">
                <span>ID</span>
                <mat-icon class="sort-icon">unfold_more</mat-icon>
              </th>
              <td mat-cell *matCellDef="let product" class="id-cell">
                {{ product.id }}
              </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="name">
              <th mat-header-cell *matHeaderCellDef class="sortable-header">
                <span>PRODUCT NAME</span>
                <mat-icon class="sort-icon">unfold_more</mat-icon>
              </th>
              <td mat-cell *matCellDef="let product" class="name-cell">
                {{ product.name }}
              </td>
            </ng-container>

            <!-- SKU Column -->
            <ng-container matColumnDef="sku">
              <th mat-header-cell *matHeaderCellDef class="sortable-header">
                <span>SKU</span>
                <mat-icon class="sort-icon">unfold_more</mat-icon>
              </th>
              <td mat-cell *matCellDef="let product" class="sku-cell">
                {{ product.sku }}
              </td>
            </ng-container>

            <!-- Price Column -->
            <ng-container matColumnDef="price">
              <th mat-header-cell *matHeaderCellDef class="sortable-header">
                <span>Price</span>
                <mat-icon class="sort-icon">unfold_more</mat-icon>
              </th>
              <td mat-cell *matCellDef="let product" class="price-cell">
                ${{ product.price | number:'1.2-2' }}
              </td>
            </ng-container>

            <!-- Stock Column -->
            <ng-container matColumnDef="stockQuantity">
              <th mat-header-cell *matHeaderCellDef class="sortable-header">
                <span>Stock</span>
                <mat-icon class="sort-icon">unfold_more</mat-icon>
              </th>
              <td mat-cell *matCellDef="let product" class="stock-cell">
                <span class="stock-badge" [class.low-stock]="product.stockQuantity < 10">
                  {{ product.stockQuantity }}
                </span>
              </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef class="actions-header">
                ACTION
              </th>
              <td mat-cell *matCellDef="let product" class="actions-cell">
                <button 
                  mat-stroked-button 
                  color="primary" 
                  class="action-button edit-button" 
                  (click)="editProduct(product.id)"
                  type="button"
                >
                  Edit
                </button>
                <button 
                  mat-stroked-button 
                  color="warn" 
                  class="action-button remove-button" 
                  (click)="deleteProduct(product.id)"
                  type="button"
                >
                  Remove
                </button>
              </td>
            </ng-container>

            <!-- Table Rows -->
            <tr mat-header-row *matHeaderRowDef="displayedColumns" class="table-header-row"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="table-data-row"></tr>
          </table>
        </div>

        <!-- Paginator -->
        <mat-paginator
          [length]="totalItems"
          [pageSize]="pageSize"
          [pageIndex]="pageIndex"
          [pageSizeOptions]="[5, 10, 20, 50]"
          (page)="onPageChange($event)"
          class="table-paginator"
        ></mat-paginator>
      </div>
    }
  </mat-card>
</div>
